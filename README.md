# MTS.Teta-auth
A repository for service AUTH for a mailing service project

# Сквозной проект
## Пользовательская история
Пользователь в браузере авторизуется на сервисе auth (эндпоинт /login) с помощью basic-авторизации. Для этого логины и хэш-суммы паролей должны быть заведены администратором в конфиг-файл сервиса auth. Сервис отправляет access jwt-куку клиенту, в которой содержится его логин, со сроком жизни 1 минута. Дополнительно к этому клиенту отправляется вспомогательная refresh-кука с токеном jwt, который тоже соджержит логин пользователя. Кука refresh должна быть действительна в течение 1 часа. По истечении этого срока пользователь считается разлогиненным. Если в момент любого запроса, кроме /login и /logout, от клиента refresh кука еще жива, а access уже протухла, то сервис auth отправляет клиенту обновленные access и refresh куки.
При обращении на эндпоинт /i сервиса profile с переданной access-кукой пользователь может увидеть информацию о себе, полученную при аутентификации, пока это только логин пользователя.
При обращении на /logout пользователь должен разлогиниться: клиенту передается установка пустых кук access и refresh
В каждом из запросов /login и /logout клиент может опционально указать путь редиректа после логина/логаута в query-параметре ?redirect_uri=... В этом случае сервис должен возвращать клиенту команду на редирект.
Все общение клиента с сервисом идет в архитектуре REST с форматом сообщений json.

## Реализация
Для сервиса auth:

>создать репозиторий и настроить его базовые параметры, линтеры, экшэны, прекоммит-хуки
>создать http-сервер, выбрать и настроить базовый роутер
>создать эндпоинты /login, /logout, по которым сервис принимает авторизацию basic auth (в дальнейшем будет переделана на другой способ авторизации) и возвращает куки access и refresh, содержащие jwt-токены
>по эндпоинту /i проверять jwt-куки на валидность и возвращать данные залогиненного пользователя (пока только логин). Предварительно jwt-токен должен быть провалидирован в мидлваре, разобран, и структура пользователя должна быть передана в хэндлер через контекст
>по эндпоинту /me валидировать jwt-токен в теле запроса, возвращать данные залогиненного пользователя (пока только логин). Здесь должна быть применена та же мидлвара, что и для /i. Хэндлер должен только лишь достать пользователя из контекста и вернуть его в ответ на запрос.
